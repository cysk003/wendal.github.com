<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Wendal随笔 Page 22</title>
  
    <meta name="author" content="Wendal Chen">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/twitter/stylesheets/bootstrap.min.css" type="text/css" rel="stylesheet" media="all">
<link href="/assets/twitter/stylesheets/style.css" type="text/css" rel="stylesheet" media="all">
<link href="/assets/twitter/widgets/google_prettify/stylesheets/twitter-bootstrap.css" type="text/css" rel="stylesheet" media="all">
 

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  </head>

  <body>

    <div class="navbar">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="/">Wendal随笔</a>
          <ul class="nav">
            
              


  <li><a href="/archive">Archive</a></li>


            
              


  <li><a href="/tags">Tags</a></li>


            
              


  <li><a href="/categories">Categories</a></li>


            
              


  <li><a href="/pages">Pages</a></li>


            
              


  <li><a href="/about">Wendal在此</a></li>


            
          </ul>
        </div>
      </div>
    </div>

    <div class="container">

      <div class="content">
        

<div class="post">
  <h3 class="title"><a href="/133.html">亚运比赛,还是没看成!</a> <span class="date">2010-11-20 08:48:42</span></h3>
  <p>6个月前买了票
2周前取了票
坐了两个小时公交车</p>

<p>到达后发现,<strong>去错场馆了</strong>!!! 严格来说,是去了同一个场馆的不同区域.这两个区域相距9公里!</p>

<p>哎,没法,去不了&hellip;</p>

  <div class="more">
    <a href="/133.html" class="btn">read more..</a>
  </div>
</div>

<div class="post">
  <h3 class="title"><a href="/126.html">取亚运门票,花了一个小时</a> <span class="date">2010-11-11 12:57:33</span></h3>
  <p>很久很久以前,买了两张亚运的门票.</p>

<p>比赛临近,觉得还是先取了吧,故飞奔到取票点. 在取票点待了5分钟,我意识到,只有我是来取票的,其他都是在买票的黄牛党!</p>

<p>天啊,咋就那么多人,他们为啥一次性买这么多! 为什么我要等那么久?!!</p>

<p>不过,我其实是支持黄牛的,本质上,这是市场经济的一种正常表现(门票也是一种普通商品,虽然票面上写着不得交易/出售).</p>

<p>商品,不能强制要求购买者不得转让,这是不符合商品自由流动的规则的! 亚运门票,一种有价证劵,是应该同时也必要能够在市场上流通. 而且,亚运门票并非公益性的(除非你是从亚运大礼包中获取),故,购买者有权处理其去留.</p>

<p>亚运门票,设计得还是不错的, 预定的门票是印刷的,黄牛拿到的门票,基本上都是当场打印的.</p>

<p>我不满的是,这么多人在购买,工行竟然只有一个人在办理!! 我讨厌四大行!!</p>

  <div class="more">
    <a href="/126.html" class="btn">read more..</a>
  </div>
</div>

<div class="post">
  <h3 class="title"><a href="/124.html">折腾了2天,终于把Nutz提交给Maven库</a> <span class="date">2010-11-10 22:07:12</span></h3>
  <p>昨天在 <a href="https://oss.sonatype.org">https://oss.sonatype.org</a> 申请将Nutz加入资源库, 相关Issue:</p>

<p><a href="https://issues.sonatype.org/browse/OSSRH-983">https://issues.sonatype.org/browse/OSSRH-983</a></p>

<p>原本以为要2天,想不到一天就通过了申请.</p>

<p>下午折腾了一下,搞到傍晚才成功上传一版,期间遇到的问题有:</p>

<ol>
<li><p>要求asc文件,开头无头绪,后来发现是gpg工具生存的.</p></li>

<li><p>提交后提示public key未登记,又折腾了一下,提交到公共服务器</p></li>

<li><p>签名无效, 神奇之极, 没办法,重新签名, 并打包为bundle,一次性提交!</p></li>
</ol>

<p>哦也,成功,release! 哈哈,发布成功:</p>

<p><a href="https://oss.sonatype.org/content/groups/staging/org/nutz/nutz/1.a.32/">https://oss.sonatype.org/content/groups/staging/org/nutz/nutz/1.a.32/</a></p>

<p>不过,很奇怪,并没要在Maven中央库找到nutz,难道是同步间隔的问题??</p>

  <div class="more">
    <a href="/124.html" class="btn">read more..</a>
  </div>
</div>

<div class="post">
  <h3 class="title"><a href="/122.html">换上1TB的希捷硬盘,虚惊一场</a> <span class="date">2010-11-08 21:57:49</span></h3>
  <p>狠下心,终于入手一块 1TB的希捷硬盘,在卓越买的,<a href="http://www.amazon.cn/gp/product/B003N63M8A/ref=oss_product">链接</a></p>

<p>欢喜地回家装进灰尘滚滚的机箱,开机!
BIOS打印了相关信息,顺利进入系统.
分区后,把旧硬盘上的资料盘往新硬盘copy,开头很快, 300M后,停了!!! 我晕,干啥??!! 马上取消,what? 取消也等了1分钟才完成!!
心想,完了,中招了!! 难道遇上固件门? 上Google搜ST31000528AS, 天啊, 之前出问题的型号!!!
不过,自行看看固件版本,不对, 有问题的是CC24,但我的是CC38,为啥??为啥?? 到底哪里有问题??!!!
在网上搜了一大堆原因后,还是没搞好!!
进BIOS,发现SMART没开,32bit没开, 难道这样都有影响? 我日,我打开,回到Windows,还是不行!!</p>

<p>难道&hellip;. 难道&hellip; 线的问题? 好吧,开机箱,选了一个接口,把灰尘认真清干净,插入!!开机!! 开始copy文件.</p>

<p>!!!!!!!!!!! 40M/s 直至完成!!! 还真是灰尘的原因!!!!!!!!!!!!!!!!!!!!!!!!!!! 我的错!! 折腾了一个晚上!!
接着下了DiscWizard,把旧硬盘克隆到新盘,Oh yeah!! 搞定!!</p>

<p>感觉系统速度有所提高,声音也小了.
前后对比:</p>

<pre><code>希捷 SATA    120G
希捷 SATA2   1TB
</code></pre>

  <div class="more">
    <a href="/122.html" class="btn">read more..</a>
  </div>
</div>

<div class="post">
  <h3 class="title"><a href="/118.html">离线下载Android SDK</a> <span class="date">2010-11-05 23:04:22</span></h3>
  <p>我实在搞不懂,为啥GFW要墙Android 的开发网站.</p>

<p>今天,把当前最新版本的Android SDK全部下载到 <a href="http://build.sunfarms.net/android/repository/">http://build.sunfarms.net/android/repository/</a>
同时发现一个问题,即使把 <a href="http://build.sunfarms.net/android/repository/repository.xml">http://build.sunfarms.net/android/repository/repository.xml</a> 添加到SDK Manager ,与Google官网一样的内容,却不认平台下载.
仔细找了一下,原来写死在代码里面的 <a href="http://code.google.com/p/android-sdk-tool/source/browse/src/main/java/com/m11n/android/AndroidSdkTool.java?r=6426c47fe356e9d649fe612464563960a1ca7d74">点击查看</a>
没办法. 只好自己编译一个了,哈哈.
Google源码截取:</p>

<pre><code>        private String repositoryUrl = &quot;http://dl-ssl.google.com/android/repository/&quot;;
        private String sdkUrl = &quot;http://dl.google.com/android/&quot;;
        private String downloadDir = System.getProperty(&quot;java.io.tmpdir&quot;) + &quot;/&quot;;
        private Boolean overwrite = true;
        private Boolean verbose = true;
        private DocumentBuilder builder;

        public AndroidSdkTool() throws ParserConfigurationException {
                builder = DocumentBuilderFactory.newInstance().newDocumentBuilder();
        }
</code></pre>

  <div class="more">
    <a href="/118.html" class="btn">read more..</a>
  </div>
</div>

<div class="post">
  <h3 class="title"><a href="/114.html">为Alfresco加速PDF文件索引速度</a> <span class="date">2010-11-01 17:14:41</span></h3>
  <p>本文仅为 <a href="http://thinkalfresco.blogspot.com/2009/03/speeding-up-pdf-indexing-alfresco-hack.html">http://thinkalfresco.blogspot.com/2009/03/speeding-up-pdf-indexing-alfresco-hack.html</a> 的 Alfresco 3.2版. 因为原文中的代码,已经无法在3.2版上使用.</p>

<p>新的代码:</p>

<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE beans PUBLIC &quot;-//SPRING//DTD BEAN//EN&quot; &quot;http://www.springframework.org/dtd/spring-beans.dtd&quot;&gt;
&lt;beans&gt;

  &lt;bean id=&quot;transformer.PdfBox&quot; class=&quot;java.lang.String&quot;&gt;&lt;/bean&gt;

  &lt;bean id=&quot;transformer.complex.OpenOffice.PdfBox&quot; class=&quot;java.lang.String&quot;&gt;&lt;/bean&gt;

  &lt;bean id=&quot;transformer.PdfToTextTool&quot; class=&quot;org.alfresco.repo.content.transform.RuntimeExecutableContentTransformerWorker&quot;&gt;
                &lt;property name=&quot;mimetypeService&quot;&gt;
                &lt;ref bean=&quot;mimetypeService&quot;&gt;&lt;/ref&gt;
            &lt;/property&gt;
                &lt;property name=&quot;transformCommand&quot;&gt;
                        &lt;bean name=&quot;transformer.pdftotext.Command&quot; class=&quot;org.alfresco.util.exec.RuntimeExec&quot;&gt;
                                &lt;property name=&quot;commandMap&quot;&gt;
                                        &lt;map&gt;
                                                &lt;entry key=&quot;.*&quot;&gt;
                                                        &lt;value&gt;/usr/bin/pdftotext -enc UTF-8 ${options} ${source} ${target}&lt;/value&gt;
                                                &lt;/entry&gt;
                                        &lt;/map&gt;
                                &lt;/property&gt;
                                &lt;property name=&quot;defaultProperties&quot;&gt;
                                        &lt;props&gt;&lt;prop key=&quot;options&quot;&gt;&lt;/prop&gt;&lt;/props&gt;
                                &lt;/property&gt;
                        &lt;/bean&gt;
                &lt;/property&gt;
</code></pre>

  <div class="more">
    <a href="/114.html" class="btn">read more..</a>
  </div>
</div>

<div class="post">
  <h3 class="title"><a href="/110.html">想不到服务器一下子就被击垮了</a> <span class="date">2010-11-01 12:11:04</span></h3>
  <p>上周末, 从同事口中得知我休假期间,Jboss服务器曾<strong>无故自己关闭</strong>了一次.</p>

<p>顿时非常惊讶,咋就会自己关闭自己呢?</p>

<p>第一反应是OOM了,一问,没啊,内存还剩好多,而且log没提示OOM.</p>

<p>难道是程序里面写了System.exit(X)之类? 扫描了一遍代码,没有啊!! 我们还不至于写这么的代码</p>

<p>奇怪的是, JBoss是按照标准的流程顺序关闭各个应用后,再shutdown完成的,并无直接被kill掉或者异常退出,也没有找到JVM报错的log.</p>

<p>由于关闭的时间点在11:37AM,故,追查nginx的access.log  , 翻翻翻, 在一堆502(Jboss已经关闭,nginx无法proxy_pass,报502)前面,有一些不寻常的请求,节选如下:</p>

<pre><code>/acunetix-wvs-test-for-some-inexistent-file-second-try

/console/j_security_check

/_vti_pvt/authors.pwd

/phpmyadmin/main.php
</code></pre>

  <div class="more">
    <a href="/110.html" class="btn">read more..</a>
  </div>
</div>

<div class="post">
  <h3 class="title"><a href="/108.html">使用Nginx搭建Http代理服务器</a> <span class="date">2010-10-24 20:42:46</span></h3>
  <p>昨天, 折腾了一个下午,终于配好了.
配置如下:</p>

<pre><code>    server {
        listen       8888;
                client_body_timeout 60000;
                client_max_body_size 1024m;
                send_timeout       60000;
                client_header_buffer_size 16k;
                large_client_header_buffers 4 64k;

                proxy_headers_hash_bucket_size 1024;
                proxy_headers_hash_max_size 4096;
                proxy_read_timeout 60000;
                proxy_send_timeout 60000;

        location / {
            resolver 8.8.8.8;
            proxy_pass http://$http_host$request_uri;
        }
    }
</code></pre>

  <div class="more">
    <a href="/108.html" class="btn">read more..</a>
  </div>
</div>

<div class="post">
  <h3 class="title"><a href="/100.html">在Nutz MVC中使用Freemarker</a> <span class="date">2010-10-20 12:27:06</span></h3>
  <p>大约一年前, axhack 发布了一篇文章 &ldquo;<a href="http://axhack.javaeye.com/blog/542441">给 nutz 添加 freemarker 视图</a>&rdquo; ,描述了如何集成nutz和freemarker.</p>

<p>前几天,我使用另外一种更简单的方法来实现(基于Nutz 1.a.33版新增的内部重定向视图),我使用的是Freemarker 2.3.16
首先, 在web.xml添加Freemarker官方文档描述的FreemarkerServlet, <a href="http://freemarker.sourceforge.net/docs/pgui_misc_servlet.html">查看原文描述</a>.</p>

<pre><code>&lt;servlet&gt;
&lt;servlet-name&gt;freemarker&lt;/servlet-name&gt;
&lt;servlet-class&gt;freemarker.ext.servlet.FreemarkerServlet&lt;/servlet-class&gt;
&lt;init-param&gt;
  &lt;param-name&gt;TemplatePath&lt;/param-name&gt;
  &lt;param-value&gt;/&lt;/param-value&gt;
&lt;/init-param&gt;
&lt;init-param&gt;
  &lt;param-name&gt;NoCache&lt;/param-name&gt;
  &lt;param-value&gt;true&lt;/param-value&gt;
&lt;/init-param&gt;
&lt;init-param&gt;
  &lt;param-name&gt;ContentType&lt;/param-name&gt;
  &lt;param-value&gt;text/html; charset=UTF-8&lt;/param-value&gt;
  &lt;!-- 我觉得不需要了,如果是内部重定向的话, nutz已经设置了编码 --&gt;
&lt;/init-param&gt;
&lt;init-param&gt;
  &lt;param-name&gt;template_update_delay&lt;/param-name&gt;
  &lt;param-value&gt;0&lt;/param-value&gt;&lt;!-- 开发时才设置为0 --&gt;
&lt;/init-param&gt;
&lt;init-param&gt;
  &lt;param-name&gt;default_encoding&lt;/param-name&gt;
  &lt;param-value&gt;UTF-8&lt;/param-value&gt; &lt;!-- 模板文件的编码 --&gt;
&lt;/init-param&gt;
&lt;init-param&gt;
  &lt;param-name&gt;number_format&lt;/param-name&gt;
  &lt;param-value&gt;0.##########&lt;/param-value&gt;
&lt;/init-param&gt;
</code></pre>

  <div class="more">
    <a href="/100.html" class="btn">read more..</a>
  </div>
</div>

<div class="post">
  <h3 class="title"><a href="/94.html">为NutLab添加一个新项目-Nutz与OpenID集成</a> <span class="date">2010-10-12 22:16:53</span></h3>
  <p>忙乎了两天, 终于把项目正确运行起来了.</p>

<p>使用即将发布的Nutz 1.a.32 ,加 JOpenID 1.0.7</p>

<p>地址: <a href="http://code.google.com/p/nutzlab/source/browse/#svn/trunk/NutOpenID">http://code.google.com/p/nutzlab/source/browse/#svn/trunk/NutOpenID</a></p>

<p>同时,发现JOpenID 1.0.7的一个Bug.
JOpenID 默认使用UTF-8来对参数进行getBytes. 当参数中还有非英文字符,且没有配置URIEncoding时,获取的byte[]是错误的.
具体代码:</p>

<pre><code>package org.expressme.openid;
//......
public class OpenIdManager {
//......

    String getHmacSha1(String data, byte[] key) {
        SecretKeySpec signingKey = new SecretKeySpec(key, HMAC_SHA1_ALGORITHM);
        Mac mac = null;
        try {
            mac = Mac.getInstance(HMAC_SHA1_ALGORITHM);
            mac.init(signingKey);
        }
        catch(NoSuchAlgorithmException e) {
            throw new OpenIdException(e);
        }
        catch(InvalidKeyException e) {
            throw new OpenIdException(e);
        }
        try {
            byte[] rawHmac = mac.doFinal(data.getBytes(&quot;UTF-8&quot;)); //不一定,也许是ASCII
            return Base64.encodeBytes(rawHmac);
        }
        catch(IllegalStateException e) {
            throw new OpenIdException(e);
        }
        catch(UnsupportedEncodingException e) {
            throw new OpenIdException(e);
        }
    }
</code></pre>

  <div class="more">
    <a href="/94.html" class="btn">read more..</a>
  </div>
</div>


<ul>

  <li>
	1
  </li>

  <li>
	2
  </li>

  <li>
	3
  </li>

  <li>
	4
  </li>

  <li>
	5
  </li>

  <li>
	6
  </li>

  <li>
	7
  </li>

  <li>
	8
  </li>

  <li>
	9
  </li>

  <li>
	10
  </li>

  <li>
	11
  </li>

  <li>
	12
  </li>

  <li>
	13
  </li>

  <li>
	14
  </li>

  <li>
	15
  </li>

  <li>
	16
  </li>

  <li>
	17
  </li>

  <li>
	18
  </li>

  <li>
	19
  </li>

  <li>
	20
  </li>

  <li>
	21
  </li>

  <li>
	22
  </li>

  <li>
	23
  </li>

  <li>
	24
  </li>

  <li>
	25
  </li>

</ul>
      </div>

      <footer>
        <p>&copy; Wendal Chen 2013 
		  Power By <a href="http://github.com/wendal/gor">Gor 极速博客引擎</a>
          and with help from <a href="http://ruhoh.com" target="_blank" title="The Definitive Technical Blogging Framework">ruhoh</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
        <p><a href="http://ip.dnspod.cn/" target="_blank">本地DNS优化</a></p>
      </footer>

    </div> <!-- /container -->

    
<script src="//cdnjscn.b0.upaiyun.com/libs/prettify/r298/prettify.min.js"></script>
<script>
  var pres = document.getElementsByTagName("pre");
  for (var i=0; i < pres.length; ++i) {
    pres[i].className = "prettyprint ";
  }
  prettyPrint();
</script>

    
<script type="text/javascript">

  var _gaq = _gaq || [];
  var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-22727186-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
	<a href="https://github.com/wendal"><img style="position: absolute; top: 0; right: 0; border: 0;" src="/assets/media/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>

  </body>
</html>
